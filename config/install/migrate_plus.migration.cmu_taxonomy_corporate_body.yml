id: cmu_taxonomy_corporate_body
label: 'Custom term migration'
migration_group: migrate_cmu_taxonomy

source:
  plugin: csv
  path: modules/contrib/migrate_islandora_csv/data/taxonomy/cmu_taxonomy_corporate_body.csv
  delimiter: '|'  

  # 1 means you have a header row, 0 means you don't
  header_row_count: 1

  # Each migration needs a unique key per row in the csv.  Here we're using the file path.
  # also use this as PID since it's unique.
  keys:
    - term_id

  constants:
    uid: 1

  # optional types of corporate body
  # org:OrganizationalUnit
  # schema:Airline
  # schema:Corporation
  # schema:EducationalOrganization
  # schema:GovernmentOrganization
  # schema:LocalBusiness
  # schema:MedicalOrganization
  # schema:NGO
  # schema:PerformingGroup
  # schema:SportsOrganization
  # schema:SportsTeam
    
  # optional types of authority links
  # cash Canadian Subject Headings
  # lcshac Library of Congress Children's Subject Headings
  # naf NACO Authority File
  # nad NAD / ARK II Name Authority Database
  # nal National Agricultural Library subject headings
  # rvm Répertoire de vedettes-matière
  # ulan Union List of Artist Names
  # other Other

    
process:

  tid: term_id
  uid: constants/uid
  name: title
  type: corp_type # i can't get this to work for some reason but the other dropdown authoritylink/source @#$@$@
  path/alias:
    plugin: skip_on_empty
    source: url_alias
    method: process

  field_authority_link/source: authority_source
  field_authority_link/uri: authority_link
  field_authority_link/title: authority_alt_title



  field_cat_date_begin:
    plugin: skip_on_empty
    source: founding_date 
    method: process
  field_cat_date_end:
    plugin: skip_on_empty 
    source: dissolution_date
    method: process

  field_corp_alt_name/value: 
    plugin: skip_on_empty
    source: alt_name
    method: process

  description:
    plugin: skip_on_empty
    source: description 
    method: process

  field_relationships/rel_type: rel_type
  field_relationships/target_id: typed_rel

  # target_id:
  #   plugin: entity_generate
  #   source: name
  #   entity_type: taxonomy_term
  #   value_key: name
  #   bundle_key: vid
  #   bundle: 'corporate_body'
  # rel_type:
  #   plugin: default_value
  #   default_value: 'relators:prv'
    
destination:
  plugin: entity:taxonomy_term
  default_bundle: corporate_body